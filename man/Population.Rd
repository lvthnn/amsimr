% Generated by roxygen2: do not edit by hand
% Please edit documentation in R/population.R
\name{Population}
\alias{Population}
\title{Population Class for Genomic Simulation}
\description{
The \code{Population} R6 class encapsulates the state and behavior of a simulated
genomic population. It manages genotype and phenotype data, supports
initialization, updating, and querying of individuals, and integrates with
phenotype and mating model classes for flexible simulation workflows.
}
\details{
The Population class simulates genomic populations with realistic genetic
structure. Generates correlated genotype data, supports multiple phenotypes,
and can advance through generations via mating simulations. The class uses
parallel processing and file-backed matrices for scalability. Once compiled,
the object becomes immutable.
}
\section{Methods}{

\itemize{
\item \code{initialize()}: Set up the initial population state.
\item \code{genotype_data()}: Get the genotype data matrix.
\item \code{phenotype_data()}: Get the phenotype data.
\item \code{haplotype_data()}: Get the haplotype data.
\item \code{recombination_rate()}: Get the recombination rate.
\item \code{n_population()}: Get the number of individuals in the population.
\item \code{n_loci()}: Get the number of loci.
\item \code{mating_model()}: Get the mating model.
\item \code{snp_mafs()}: Get the SNP minor allele frequencies.
\item \code{phenotypes()}: Get the list of phenotypes.
\item \code{generation()}: Get the current generation.
\item \code{set_mating_model()}: Set the mating model.
\item \code{add_phenotype()}: Add a phenotype to the population.
\item \code{remove_phenotype()}: Remove a phenotype from the population.
\item \code{compile()}: Compile and initialize the population data.
}
}

\seealso{
Other related classes and functions: \code{Phenotype}, \code{MatingModel}
}
\section{Methods}{
\subsection{Public methods}{
\itemize{
\item \href{#method-Population-new}{\code{Population$new()}}
\item \href{#method-Population-genotype_data}{\code{Population$genotype_data()}}
\item \href{#method-Population-phenotype_data}{\code{Population$phenotype_data()}}
\item \href{#method-Population-haplotype_data}{\code{Population$haplotype_data()}}
\item \href{#method-Population-recombination_rate}{\code{Population$recombination_rate()}}
\item \href{#method-Population-n_population}{\code{Population$n_population()}}
\item \href{#method-Population-n_loci}{\code{Population$n_loci()}}
\item \href{#method-Population-mating_model}{\code{Population$mating_model()}}
\item \href{#method-Population-snp_mafs}{\code{Population$snp_mafs()}}
\item \href{#method-Population-phenotypes}{\code{Population$phenotypes()}}
\item \href{#method-Population-generation}{\code{Population$generation()}}
\item \href{#method-Population-set_mating_model}{\code{Population$set_mating_model()}}
\item \href{#method-Population-add_phenotype}{\code{Population$add_phenotype()}}
\item \href{#method-Population-remove_phenotype}{\code{Population$remove_phenotype()}}
\item \href{#method-Population-compile}{\code{Population$compile()}}
\item \href{#method-Population-clone}{\code{Population$clone()}}
}
}
\if{html}{\out{<hr>}}
\if{html}{\out{<a id="method-Population-new"></a>}}
\if{latex}{\out{\hypertarget{method-Population-new}{}}}
\subsection{Method \code{new()}}{
Initialize a new Population object
\subsection{Usage}{
\if{html}{\out{<div class="r">}}\preformatted{Population$new(
  n_population,
  n_loci,
  recombination_rate = 1e-08,
  snp_dist = "beta",
  snp_params = c(5, 5),
  phenotypes = NULL,
  mating_model = NULL
)}\if{html}{\out{</div>}}
}

\subsection{Arguments}{
\if{html}{\out{<div class="arguments">}}
\describe{
\item{\code{n_population}}{Integer. The number of individuals in the population.
Must be even.}

\item{\code{n_loci}}{Integer. The number of genetic loci to simulate.}

\item{\code{recombination_rate}}{Numeric. The recombination rate between loci
(default: 1e-8).}

\item{\code{snp_dist}}{Character. Distribution for SNP minor allele frequencies
("beta" or "unif").}

\item{\code{snp_params}}{Numeric vector of length 2. Parameters for the SNP
distribution.}

\item{\code{phenotypes}}{Phenotype object or NULL. Optional phenotype to
associate with the population.}

\item{\code{mating_model}}{MatingModel object or NULL. Optional mating model for
the population.}
}
\if{html}{\out{</div>}}
}
\subsection{Returns}{
A new Population object.
}
}
\if{html}{\out{<hr>}}
\if{html}{\out{<a id="method-Population-genotype_data"></a>}}
\if{latex}{\out{\hypertarget{method-Population-genotype_data}{}}}
\subsection{Method \code{genotype_data()}}{
Get the genotype data matrix
\subsection{Usage}{
\if{html}{\out{<div class="r">}}\preformatted{Population$genotype_data()}\if{html}{\out{</div>}}
}

\subsection{Returns}{
Matrix or FBM object containing genotype data for all individuals
}
}
\if{html}{\out{<hr>}}
\if{html}{\out{<a id="method-Population-phenotype_data"></a>}}
\if{latex}{\out{\hypertarget{method-Population-phenotype_data}{}}}
\subsection{Method \code{phenotype_data()}}{
Get the phenotype data
\subsection{Usage}{
\if{html}{\out{<div class="r">}}\preformatted{Population$phenotype_data()}\if{html}{\out{</div>}}
}

\subsection{Returns}{
Data frame or matrix containing phenotype values for all
individuals
}
}
\if{html}{\out{<hr>}}
\if{html}{\out{<a id="method-Population-haplotype_data"></a>}}
\if{latex}{\out{\hypertarget{method-Population-haplotype_data}{}}}
\subsection{Method \code{haplotype_data()}}{
Get the haplotype data
\subsection{Usage}{
\if{html}{\out{<div class="r">}}\preformatted{Population$haplotype_data()}\if{html}{\out{</div>}}
}

\subsection{Returns}{
Matrix containing haplotype data for all individuals
}
}
\if{html}{\out{<hr>}}
\if{html}{\out{<a id="method-Population-recombination_rate"></a>}}
\if{latex}{\out{\hypertarget{method-Population-recombination_rate}{}}}
\subsection{Method \code{recombination_rate()}}{
Get the recombination rate
\subsection{Usage}{
\if{html}{\out{<div class="r">}}\preformatted{Population$recombination_rate()}\if{html}{\out{</div>}}
}

\subsection{Returns}{
Numeric value representing the recombination rate between loci
}
}
\if{html}{\out{<hr>}}
\if{html}{\out{<a id="method-Population-n_population"></a>}}
\if{latex}{\out{\hypertarget{method-Population-n_population}{}}}
\subsection{Method \code{n_population()}}{
Get the number of individuals in the population
\subsection{Usage}{
\if{html}{\out{<div class="r">}}\preformatted{Population$n_population()}\if{html}{\out{</div>}}
}

\subsection{Returns}{
Integer number of individuals in the population
}
}
\if{html}{\out{<hr>}}
\if{html}{\out{<a id="method-Population-n_loci"></a>}}
\if{latex}{\out{\hypertarget{method-Population-n_loci}{}}}
\subsection{Method \code{n_loci()}}{
Get the number of genetic loci
\subsection{Usage}{
\if{html}{\out{<div class="r">}}\preformatted{Population$n_loci()}\if{html}{\out{</div>}}
}

\subsection{Returns}{
Integer number of loci being simulated
}
}
\if{html}{\out{<hr>}}
\if{html}{\out{<a id="method-Population-mating_model"></a>}}
\if{latex}{\out{\hypertarget{method-Population-mating_model}{}}}
\subsection{Method \code{mating_model()}}{
Get the mating model
\subsection{Usage}{
\if{html}{\out{<div class="r">}}\preformatted{Population$mating_model()}\if{html}{\out{</div>}}
}

\subsection{Returns}{
MatingModel object or NULL if no mating model is set
}
}
\if{html}{\out{<hr>}}
\if{html}{\out{<a id="method-Population-snp_mafs"></a>}}
\if{latex}{\out{\hypertarget{method-Population-snp_mafs}{}}}
\subsection{Method \code{snp_mafs()}}{
Get the SNP minor allele frequencies
\subsection{Usage}{
\if{html}{\out{<div class="r">}}\preformatted{Population$snp_mafs()}\if{html}{\out{</div>}}
}

\subsection{Returns}{
Named numeric vector of minor allele frequencies for each SNP
}
}
\if{html}{\out{<hr>}}
\if{html}{\out{<a id="method-Population-phenotypes"></a>}}
\if{latex}{\out{\hypertarget{method-Population-phenotypes}{}}}
\subsection{Method \code{phenotypes()}}{
Get the list of phenotypes
\subsection{Usage}{
\if{html}{\out{<div class="r">}}\preformatted{Population$phenotypes()}\if{html}{\out{</div>}}
}

\subsection{Returns}{
Named list of Phenotype objects associated with the population
}
}
\if{html}{\out{<hr>}}
\if{html}{\out{<a id="method-Population-generation"></a>}}
\if{latex}{\out{\hypertarget{method-Population-generation}{}}}
\subsection{Method \code{generation()}}{
Get the current generation number
\subsection{Usage}{
\if{html}{\out{<div class="r">}}\preformatted{Population$generation()}\if{html}{\out{</div>}}
}

\subsection{Returns}{
Integer representing the current generation (0 for initial
generation)
}
}
\if{html}{\out{<hr>}}
\if{html}{\out{<a id="method-Population-set_mating_model"></a>}}
\if{latex}{\out{\hypertarget{method-Population-set_mating_model}{}}}
\subsection{Method \code{set_mating_model()}}{
Set the mating model for the population
\subsection{Usage}{
\if{html}{\out{<div class="r">}}\preformatted{Population$set_mating_model(mating_model)}\if{html}{\out{</div>}}
}

\subsection{Arguments}{
\if{html}{\out{<div class="arguments">}}
\describe{
\item{\code{mating_model}}{MatingModel object to be used for mating decisions}
}
\if{html}{\out{</div>}}
}
\subsection{Details}{
This method can only be called before the population is
compiled.
}

\subsection{Returns}{
No return value. Modifies the population's mating model.
}
}
\if{html}{\out{<hr>}}
\if{html}{\out{<a id="method-Population-add_phenotype"></a>}}
\if{latex}{\out{\hypertarget{method-Population-add_phenotype}{}}}
\subsection{Method \code{add_phenotype()}}{
Add a phenotype to the population
\subsection{Usage}{
\if{html}{\out{<div class="r">}}\preformatted{Population$add_phenotype(phenotype)}\if{html}{\out{</div>}}
}

\subsection{Arguments}{
\if{html}{\out{<div class="arguments">}}
\describe{
\item{\code{phenotype}}{Phenotype object to be added to the population}
}
\if{html}{\out{</div>}}
}
\subsection{Details}{
This method can only be called before the population is
compiled.
}

\subsection{Returns}{
No return value. Adds the phenotype to the population's list of
phenotypes.
}
}
\if{html}{\out{<hr>}}
\if{html}{\out{<a id="method-Population-remove_phenotype"></a>}}
\if{latex}{\out{\hypertarget{method-Population-remove_phenotype}{}}}
\subsection{Method \code{remove_phenotype()}}{
Remove a phenotype from the population
\subsection{Usage}{
\if{html}{\out{<div class="r">}}\preformatted{Population$remove_phenotype(phenotype_name)}\if{html}{\out{</div>}}
}

\subsection{Arguments}{
\if{html}{\out{<div class="arguments">}}
\describe{
\item{\code{phenotype_name}}{Character string. The name of the phenotype to
remove}
}
\if{html}{\out{</div>}}
}
\subsection{Details}{
This method can only be called before the population is
compiled.
}

\subsection{Returns}{
No return value. Removes the phenotype from the population's list
of phenotypes.
}
}
\if{html}{\out{<hr>}}
\if{html}{\out{<a id="method-Population-compile"></a>}}
\if{latex}{\out{\hypertarget{method-Population-compile}{}}}
\subsection{Method \code{compile()}}{
Compile and initialize the population data
\subsection{Usage}{
\if{html}{\out{<div class="r">}}\preformatted{Population$compile(verbose = TRUE)}\if{html}{\out{</div>}}
}

\subsection{Arguments}{
\if{html}{\out{<div class="arguments">}}
\describe{
\item{\code{verbose}}{Logical. Whether to display progress messages during
compilation (default: TRUE)}
}
\if{html}{\out{</div>}}
}
\subsection{Details}{
This method must be called after all phenotypes and mating
models have been set up. It initializes the genotype data, generates
sibling pairs, and sets up phenotypes. Once compiled, the population
object cannot be modified.
}

\subsection{Returns}{
No return value. Compiles the population object and initialises
all data structures.
}
}
\if{html}{\out{<hr>}}
\if{html}{\out{<a id="method-Population-clone"></a>}}
\if{latex}{\out{\hypertarget{method-Population-clone}{}}}
\subsection{Method \code{clone()}}{
The objects of this class are cloneable with this method.
\subsection{Usage}{
\if{html}{\out{<div class="r">}}\preformatted{Population$clone(deep = FALSE)}\if{html}{\out{</div>}}
}

\subsection{Arguments}{
\if{html}{\out{<div class="arguments">}}
\describe{
\item{\code{deep}}{Whether to make a deep clone.}
}
\if{html}{\out{</div>}}
}
}
}
