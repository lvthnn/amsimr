% Generated by roxygen2: do not edit by hand
% Please edit documentation in R/simulation.R
\name{Simulation}
\alias{Simulation}
\title{Simulation Configuration}
\description{
An R6 class for configuring and running genetic simulations with assortative
mating. This class provides a builder pattern interface for setting update
simulation parameters including genome architecture, phenotypic traits,
mating strategies, as well as the metrics and statistics used to produce
output data for analysis.
}
\details{
The Simulation class allows configuration of:
\itemize{
\item Basic simulation parameters (generations, population size, output)
\item Genome architecture (loci, MAF, recombination, mutation rates)
\item Phenome specification (traits, heritability, correlations)
\item Mating strategies (random or assortative)
\item Metrics collection
}

All configuration methods return \code{self} for method chaining.
}
\examples{
\dontrun{
sim <- Simulation$new()
sim$simulation(
  n_generations = 100,
  n_individuals = 1000,
  output_dir = "output",
  random_seed = 42
)$genome(
  n_loci = 1000,
  locus_maf = 0.3,
  locus_recombination = 0.5,
  locus_mutation = 1e-8
)$phenome(
  n_phenotypes = 2,
  names = c("height", "weight"),
  n_causal_loci = c(100, 100),
  h2_genetic = c(0.5, 0.6),
  h2_environmental = c(0.3, 0.2),
  h2_vertical = c(0.2, 0.2),
  genetic_cor = diag(2),
  environmental_cor = diag(2)
)$random_mating()$metrics(
  pheno_h2(),
  pheno_comp_xcor("total")
)
}


## ------------------------------------------------
## Method `Simulation$run`
## ------------------------------------------------

\dontrun{
sim <- Simulation$new()
# ... configure simulation ...
sim$run(
  n_replicates = 10,
  n_threads = 4,
  summarise = TRUE,
  log_level = "info"
)
}
}
\section{Active bindings}{
\if{html}{\out{<div class="r6-active-bindings">}}
\describe{
\item{\code{n_generations}}{Number of generations}

\item{\code{n_individuals}}{Population size}

\item{\code{output_dir}}{Output directory path}

\item{\code{random_seed}}{Random seed value}

\item{\code{n_loci}}{Number of genetic loci}

\item{\code{locus_maf}}{Vector of locus minor allele frequencies}

\item{\code{locus_recombination}}{Vector of locus recombination probabilities}

\item{\code{locus_mutation}}{Vector of locus mutation probabilities}

\item{\code{n_phenotypes}}{Number of phenotypes}

\item{\code{phenotype_names}}{Vector of phenotype names}

\item{\code{n_causal_loci}}{Vector of causal loci counts per phenotype}

\item{\code{h2_genetic}}{Vector of narrow-sense heritabilities}

\item{\code{h2_environmental}}{Vector of environmental variance components}

\item{\code{h2_vertical}}{Vector of vertical transmission components}

\item{\code{genetic_cor}}{Genetic correlation matrix}

\item{\code{environmental_cor}}{Environmental correlation matrix}

\item{\code{mate_cor}}{Mating correlation matrix}

\item{\code{tol_inf}}{Annealing tolerance threshold}

\item{\code{n_iterations}}{Maximum number of annealing iterations}

\item{\code{temp_init}}{Initial annealing temperature}

\item{\code{temp_decay}}{Annealing temperature decay rate}

\item{\code{results}}{Summary statistic of metrics from simulation}
}
\if{html}{\out{</div>}}
}
\section{Methods}{
\subsection{Public methods}{
\itemize{
\item \href{#method-Simulation-new}{\code{Simulation$new()}}
\item \href{#method-Simulation-simulation}{\code{Simulation$simulation()}}
\item \href{#method-Simulation-genome}{\code{Simulation$genome()}}
\item \href{#method-Simulation-phenome}{\code{Simulation$phenome()}}
\item \href{#method-Simulation-random_mating}{\code{Simulation$random_mating()}}
\item \href{#method-Simulation-assortative_mating}{\code{Simulation$assortative_mating()}}
\item \href{#method-Simulation-metrics}{\code{Simulation$metrics()}}
\item \href{#method-Simulation-run}{\code{Simulation$run()}}
\item \href{#method-Simulation-clone}{\code{Simulation$clone()}}
}
}
\if{html}{\out{<hr>}}
\if{html}{\out{<a id="method-Simulation-new"></a>}}
\if{latex}{\out{\hypertarget{method-Simulation-new}{}}}
\subsection{Method \code{new()}}{
Create a new Simulation object
\subsection{Usage}{
\if{html}{\out{<div class="r">}}\preformatted{Simulation$new()}\if{html}{\out{</div>}}
}

}
\if{html}{\out{<hr>}}
\if{html}{\out{<a id="method-Simulation-simulation"></a>}}
\if{latex}{\out{\hypertarget{method-Simulation-simulation}{}}}
\subsection{Method \code{simulation()}}{
Configure basic simulation parameters
\subsection{Usage}{
\if{html}{\out{<div class="r">}}\preformatted{Simulation$simulation(
  n_generations,
  n_individuals,
  output_dir,
  random_seed = NULL
)}\if{html}{\out{</div>}}
}

\subsection{Arguments}{
\if{html}{\out{<div class="arguments">}}
\describe{
\item{\code{n_generations}}{Integer. Number of generations to simulate.}

\item{\code{n_individuals}}{Integer. Population size.}

\item{\code{output_dir}}{String. Directory path for output files.}

\item{\code{random_seed}}{Integer or NULL. Random seed for reproducibility.}
}
\if{html}{\out{</div>}}
}
\subsection{Returns}{
Self, invisibly, for method chaining.
}
}
\if{html}{\out{<hr>}}
\if{html}{\out{<a id="method-Simulation-genome"></a>}}
\if{latex}{\out{\hypertarget{method-Simulation-genome}{}}}
\subsection{Method \code{genome()}}{
Configure genome architecture
\subsection{Usage}{
\if{html}{\out{<div class="r">}}\preformatted{Simulation$genome(n_loci, locus_maf, locus_recombination, locus_mutation)}\if{html}{\out{</div>}}
}

\subsection{Arguments}{
\if{html}{\out{<div class="arguments">}}
\describe{
\item{\code{n_loci}}{Integer. Number of genetic loci.}

\item{\code{locus_maf}}{Numeric vector. Minor allele frequencies for each locus.
Can be a single value (recycled) or a vector of length \code{n_loci}.}

\item{\code{locus_recombination}}{Numeric vector. Recombination probabilities.
Can be a single value (recycled) or a vector of length \code{n_loci}.}

\item{\code{locus_mutation}}{Numeric vector. Mutation probabilities.
Can be a single value (recycled) or a vector of length \code{n_loci}.}
}
\if{html}{\out{</div>}}
}
\subsection{Returns}{
Self, invisibly, for method chaining.
}
}
\if{html}{\out{<hr>}}
\if{html}{\out{<a id="method-Simulation-phenome"></a>}}
\if{latex}{\out{\hypertarget{method-Simulation-phenome}{}}}
\subsection{Method \code{phenome()}}{
Configure phenome (trait) architecture
\subsection{Usage}{
\if{html}{\out{<div class="r">}}\preformatted{Simulation$phenome(
  n_phenotypes,
  names,
  n_causal_loci,
  h2_genetic,
  h2_environmental,
  h2_vertical,
  genetic_cor,
  environmental_cor
)}\if{html}{\out{</div>}}
}

\subsection{Arguments}{
\if{html}{\out{<div class="arguments">}}
\describe{
\item{\code{n_phenotypes}}{Integer. Number of phenotypic traits.}

\item{\code{names}}{Character vector. Names for each phenotype.}

\item{\code{n_causal_loci}}{Integer vector. Number of causal loci per phenotype.}

\item{\code{h2_genetic}}{Numeric vector. Narrow-sense heritabilities.}

\item{\code{h2_environmental}}{Numeric vector. Environmental variance
components.}

\item{\code{h2_vertical}}{Numeric vector. Vertical transmission components.}

\item{\code{genetic_cor}}{Numeric matrix. Genetic correlation matrix.}

\item{\code{environmental_cor}}{Numeric matrix. Environmental correlation
matrix.}
}
\if{html}{\out{</div>}}
}
\subsection{Returns}{
Self, invisibly, for method chaining.
}
}
\if{html}{\out{<hr>}}
\if{html}{\out{<a id="method-Simulation-random_mating"></a>}}
\if{latex}{\out{\hypertarget{method-Simulation-random_mating}{}}}
\subsection{Method \code{random_mating()}}{
Configure random mating strategy
\subsection{Usage}{
\if{html}{\out{<div class="r">}}\preformatted{Simulation$random_mating()}\if{html}{\out{</div>}}
}

\subsection{Returns}{
Self, invisibly, for method chaining.
}
}
\if{html}{\out{<hr>}}
\if{html}{\out{<a id="method-Simulation-assortative_mating"></a>}}
\if{latex}{\out{\hypertarget{method-Simulation-assortative_mating}{}}}
\subsection{Method \code{assortative_mating()}}{
Configure assortative mating strategy
\subsection{Usage}{
\if{html}{\out{<div class="r">}}\preformatted{Simulation$assortative_mating(
  mate_cor = mate_cor,
  tol_inf = NULL,
  n_iterations = NULL,
  temp_init = NULL,
  temp_decay = NULL
)}\if{html}{\out{</div>}}
}

\subsection{Arguments}{
\if{html}{\out{<div class="arguments">}}
\describe{
\item{\code{mate_cor}}{Numeric matrix. Mating correlation matrix.}

\item{\code{tol_inf}}{Numeric or NULL. Tolerance threshold for annealing.}

\item{\code{n_iterations}}{Integer or NULL. Maximum annealing iterations.}

\item{\code{temp_init}}{Numeric or NULL. Initial annealing temperature.}

\item{\code{temp_decay}}{Numeric or NULL. Temperature decay rate.}
}
\if{html}{\out{</div>}}
}
\subsection{Returns}{
Self, invisibly, for method chaining.
}
}
\if{html}{\out{<hr>}}
\if{html}{\out{<a id="method-Simulation-metrics"></a>}}
\if{latex}{\out{\hypertarget{method-Simulation-metrics}{}}}
\subsection{Method \code{metrics()}}{
Configure simulation metrics
\subsection{Usage}{
\if{html}{\out{<div class="r">}}\preformatted{Simulation$metrics(metrics = list())}\if{html}{\out{</div>}}
}

\subsection{Arguments}{
\if{html}{\out{<div class="arguments">}}
\describe{
\item{\code{metrics}}{List. List of metric specification objects.}
}
\if{html}{\out{</div>}}
}
\subsection{Returns}{
Self, invisibly, for method chaining.
}
}
\if{html}{\out{<hr>}}
\if{html}{\out{<a id="method-Simulation-run"></a>}}
\if{latex}{\out{\hypertarget{method-Simulation-run}{}}}
\subsection{Method \code{run()}}{
Run the configured genetic simulation
\subsection{Usage}{
\if{html}{\out{<div class="r">}}\preformatted{Simulation$run(
  n_replicates,
  n_threads,
  summarise = TRUE,
  log_file = TRUE,
  log_level = "info"
)}\if{html}{\out{</div>}}
}

\subsection{Arguments}{
\if{html}{\out{<div class="arguments">}}
\describe{
\item{\code{n_replicates}}{Integer. Number of independent simulation replicates.}

\item{\code{n_threads}}{Integer. Number of parallel threads for execution.}

\item{\code{summarise}}{Logical. If TRUE, aggregate results across replicates
(default: TRUE).}

\item{\code{log_file}}{Logical. If TRUE, write log messages to file
(default: TRUE).}

\item{\code{log_level}}{String. Logging verbosity: "trace", "debug", "info",
"warn", "error", or "critical" (default: "info").}
}
\if{html}{\out{</div>}}
}
\subsection{Details}{
Executes the simulation pipeline with the configured parameters. The
simulation runs for the specified number of replicates, optionally using
multiple threads for parallel execution. Results are written to the
configured output directory.

The simulation proceeds through the following steps for each generation:
\enumerate{
\item Evaluate phenotypes for all individuals
\item Perform mating according to the configured strategy
\item Generate offspring through reproduction (recombination and mutation)
\item Collect configured metrics
\item Write output data
}
}

\subsection{Returns}{
Self (invisibly). Results are written to the output directory. If
the summarise argument is TRUE, the data are aggregated into summary
statistic tables and are made accesssible under the results field.
}
\subsection{Examples}{
\if{html}{\out{<div class="r example copy">}}
\preformatted{\dontrun{
sim <- Simulation$new()
# ... configure simulation ...
sim$run(
  n_replicates = 10,
  n_threads = 4,
  summarise = TRUE,
  log_level = "info"
)
}
}
\if{html}{\out{</div>}}

}

}
\if{html}{\out{<hr>}}
\if{html}{\out{<a id="method-Simulation-clone"></a>}}
\if{latex}{\out{\hypertarget{method-Simulation-clone}{}}}
\subsection{Method \code{clone()}}{
The objects of this class are cloneable with this method.
\subsection{Usage}{
\if{html}{\out{<div class="r">}}\preformatted{Simulation$clone(deep = FALSE)}\if{html}{\out{</div>}}
}

\subsection{Arguments}{
\if{html}{\out{<div class="arguments">}}
\describe{
\item{\code{deep}}{Whether to make a deep clone.}
}
\if{html}{\out{</div>}}
}
}
}
